(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{66117:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/explore",function(){return c(21414)}])},21414:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return ah}});var d,e,f,g=c(47568),h=c(26042),i=c(69396),j=c(29815),k=c(34051),l=c.n(k),m=c(85893),n=c(585),o=c(44856),p=c(82108),q=c(49806),r=c(87913),s=c(99099),t=c(99253),u=c(33040),v=c(14685),w=c(54266),x=c(93276),y=c(67294),z=c(14924);(f=d||(d={})).GPT_3_5="gpt-3.5-turbo",f.GPT_3_5_AZ="gpt-35-turbo",f.GPT_4="gpt-4",f.GPT_4_32K="gpt-4-32k",d.GPT_3_5;var A=(e={},(0,z.Z)(e,d.GPT_3_5,{id:d.GPT_3_5,name:"GPT-3.5",maxLength:12e3,tokenLimit:4e3}),(0,z.Z)(e,d.GPT_3_5_AZ,{id:d.GPT_3_5_AZ,name:"GPT-3.5",maxLength:12e3,tokenLimit:4e3}),(0,z.Z)(e,d.GPT_4,{id:d.GPT_4,name:"GPT-4",maxLength:24e3,tokenLimit:8e3}),(0,z.Z)(e,d.GPT_4_32K,{id:d.GPT_4_32K,name:"GPT-4-32K",maxLength:96e3,tokenLimit:32e3}),e),B=c(86501),C=c(99534),D=c(90553),E=c(8861),F=c(21942),G=c(74075),H=c(88198),I=c(93625),J=c(67828),K=c(80335),L=c(66009),M=c(84283),N=c(86269),O=c(78971),P=(0,y.memo)(function(a){var b=a.language,c=a.value,d=(0,O.$G)("markdown").t,e=(0,y.useState)(!1),f=e[0],g=e[1],h=function(){navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(c).then(function(){g(!0),setTimeout(function(){g(!1)},2e3)})},i=function(){var a=N.Me[b]||".file",e="file-".concat((0,N.zs)(3,!0)).concat(a),f=window.prompt(d("Enter file name")||"",e);if(f){var g=new Blob([c],{type:"text/plain"}),h=URL.createObjectURL(g),i=document.createElement("a");i.download=f,i.href=h,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(h)}};return(0,m.jsxs)("div",{className:"codeblock relative font-sans text-[16px]",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-4",children:[(0,m.jsx)("span",{className:"text-xs lowercase text-white",children:b}),(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsxs)("button",{className:"flex gap-1.5 items-center rounded bg-none p-1 text-xs text-white",onClick:h,children:[f?(0,m.jsx)(H.Z,{size:18}):(0,m.jsx)(J.Z,{size:18}),f?d("Copied!"):d("Copy code")]}),(0,m.jsx)("button",{className:"flex items-center rounded bg-none p-1 text-xs text-white",onClick:i,children:(0,m.jsx)(K.Z,{size:18})})]})]}),(0,m.jsx)(L.Z,{language:b,style:M.vk,customStyle:{margin:0},children:c})]})});P.displayName="CodeBlock";var Q=c(74655),R=(0,y.memo)(Q.D,function(a,b){return a.children===b.children}),S=c(14769),T=c(30399),U=c(45884),V=c(12451),W=c(254),X=(0,y.memo)(function(a){var b,c=a.messages,d=a.messageIsStreaming,e=a.message,f=a.setMessages,g=a.messageIndex,k=a.onEdit,l=(0,O.$G)("chat").t,n=(0,y.useState)(!1),o=n[0],p=n[1],q=(0,y.useState)(!1),r=q[0],s=q[1],t=(0,y.useState)(e.content),u=t[0],v=t[1],w=(0,y.useState)(!1),x=w[0],z=w[1],A=(0,y.useRef)(null),B=function(){p(!o)},J=function(a){v(a.target.value),A.current&&(A.current.style.height="inherit",A.current.style.height="".concat(A.current.scrollHeight,"px"))},K=function(){e.content!=u&&k&&k((0,i.Z)((0,h.Z)({},e),{content:u})),p(!1)},L=function(){var a=c.findIndex(function(a){return a===e});a<0||(a<c.length-1&&"assistant"===c[a+1].role?f((0,j.Z)(c.splice(a,2))):f((0,j.Z)(c.splice(a,1))))},M=function(a){"Enter"!==a.key||r||a.shiftKey||(a.preventDefault(),K())},N=function(){navigator.clipboard&&navigator.clipboard.writeText(e.content).then(function(){z(!0),setTimeout(function(){z(!1)},2e3)})};return(0,y.useEffect)(function(){v(e.content)},[e.content]),(0,y.useEffect)(function(){A.current&&(A.current.style.height="inherit",A.current.style.height="".concat(A.current.scrollHeight,"px"))},[o]),(0,m.jsx)(V.E.div,(0,i.Z)((0,h.Z)({className:"group md:px-4 ".concat("assistant"===e.role?"border-b border-black/10 dark:border-gray-900/50 hover-animation bg-main-sidebar-background":"border-b border-black/10 dark:border-gray-900/50 hover-animation bg-main-background"),style:{overflowWrap:"anywhere"}},W.o),{children:(0,m.jsxs)("div",{className:"relative m-auto flex p-4 text-base md:max-w-2xl md:gap-6 md:py-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:[(0,m.jsx)("div",{className:"min-w-[40px] text-right font-bold",children:"assistant"===e.role?(0,m.jsx)(D.Z,{size:30}):(0,m.jsx)(E.Z,{size:30})}),(0,m.jsx)("div",{className:"prose mt-[-2px] w-full dark:prose-invert",children:"user"===e.role?(0,m.jsxs)("div",{className:"flex w-full",children:[o?(0,m.jsxs)("div",{className:"flex w-full flex-col",children:[(0,m.jsx)("textarea",{ref:A,className:"w-full resize-none whitespace-pre-wrap border-none dark:bg-[#343541]",value:u,onChange:J,onKeyDown:M,onCompositionStart:function(){return s(!0)},onCompositionEnd:function(){return s(!1)},style:{fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",padding:"0",margin:"0",overflow:"hidden"}}),(0,m.jsxs)("div",{className:"mt-10 flex justify-center space-x-4",children:[(0,m.jsx)("button",{className:"h-[40px] rounded-md bg-blue-500 px-4 py-1 text-sm font-medium text-white enabled:hover:bg-blue-600 disabled:opacity-50",onClick:K,disabled:u.trim().length<=0,children:l("Save & Submit")}),(0,m.jsx)("button",{className:"h-[40px] rounded-md border border-neutral-300 px-4 py-1 text-sm font-medium text-neutral-700 hover:bg-neutral-100 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-800",onClick:function(){v(e.content),p(!1)},children:l("Cancel")})]})]}):(0,m.jsx)("div",{className:"prose whitespace-pre-wrap dark:prose-invert flex-1",children:e.content}),!o&&(0,m.jsxs)("div",{className:"md:-ml-20 flex flex-col md:flex-row gap-4 md:gap-1 items-center md:items-start justify-end md:justify-start",children:[(0,m.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:B,children:(0,m.jsx)(F.Z,{size:20})}),(0,m.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:L,children:(0,m.jsx)(G.Z,{size:20})})]})]}):(0,m.jsxs)("div",{className:"flex flex-row",children:[(0,m.jsx)(R,{className:"prose dark:prose-invert flex-1",remarkPlugins:[S.Z,T.Z],rehypePlugins:[U.Z],components:{code:function(a){a.node;var b=a.inline,c=a.className,d=a.children,e=(0,C.Z)(a,["node","inline","className","children"]);if(d.length){if("▍"==d[0])return(0,m.jsx)("span",{className:"animate-pulse cursor-default mt-1",children:"▍"});d[0]=d[0].replace("`▍`","▍")}var f=/language-(\w+)/.exec(c||"");return b?(0,m.jsx)("code",(0,i.Z)((0,h.Z)({className:c},e),{children:d})):(0,m.jsx)(P,(0,h.Z)({language:f&&f[1]||"",value:String(d).replace(/\n$/,"")},e),Math.random())},table:function(a){var b=a.children;return(0,m.jsx)("table",{className:"border-collapse border border-black px-3 py-1 dark:border-white",children:b})},th:function(a){var b=a.children;return(0,m.jsx)("th",{className:"break-words border border-black bg-gray-500 px-3 py-1 text-white dark:border-white",children:b})},td:function(a){var b=a.children;return(0,m.jsx)("td",{className:"break-words border border-black px-3 py-1 dark:border-white",children:b})}},children:"".concat(e.content).concat(d&&g==(null!==(b=c.length)&& void 0!==b?b:0)-1?"`▍`":"")}),(0,m.jsx)("div",{className:"md:-mr-8 ml-1 md:ml-0 flex flex-col md:flex-row gap-4 md:gap-1 items-center md:items-start justify-end md:justify-start",children:x?(0,m.jsx)(H.Z,{size:20,className:"text-green-500 dark:text-green-400"}):(0,m.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:N,children:(0,m.jsx)(I.Z,{size:20})})})]})})]})}))});X.displayName="ChatMessage";var Y=(0,y.memo)(X,function(a,b){return a.message.content===b.message.content}),Z=function(){return(0,m.jsx)("div",{className:"group border-b border-black/10 bg-gray-50 text-gray-800 dark:border-gray-900/50 dark:bg-[#444654] dark:text-gray-100",style:{overflowWrap:"anywhere"},children:(0,m.jsxs)("div",{className:"m-auto flex gap-4 p-4 text-base md:max-w-2xl md:gap-6 md:py-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:[(0,m.jsx)("div",{className:"min-w-[40px] items-end",children:(0,m.jsx)(D.Z,{size:30})}),(0,m.jsx)("span",{className:"animate-pulse cursor-default mt-1",children:"▍"})]})})},$=c(94568),_=c(21223),aa=c(23461),ab=c(63072),ac=function(a){var b,c=a.onSend,d=a.onRegenerate,e=a.onScrollDownClick,f=a.stopConversationRef,g=a.textareaRef,h=a.showScrollDownButton,i=a.messageIsStreaming,j=a.messages,k=(0,O.$G)("chat").t,l=(0,y.useState)(),n=l[0],o=l[1],p=(0,y.useState)(!1),q=p[0],r=p[1],s=(0,y.useState)(!1),t=s[0],u=s[1],v=(0,y.useState)(0),w=(v[0],v[1]),x=(0,y.useState)("");x[0],x[1];var z=(0,y.useState)([]);z[0],z[1];var A=(0,y.useState)(!1);A[0],A[1];var B=(0,y.useState)(!1),C=B[0],D=B[1],E=(0,y.useState)(null),F=E[0],G=E[1];(0,y.useRef)(null);var H=function(a){var b=a.target.value;if(b.length>12e3){alert(k("Message limit is {{maxLength}} characters. You have entered {{valueLength}} characters.",{maxLength:12e3,valueLength:b.length}));return}o(b)},I=function(){if(!i){if(!n){alert(k("Please enter a message"));return}c({role:"user",content:n},F),o(""),G(null),window.innerWidth<640&&g&&g.current&&g.current.blur()}},J=function(){f.current=!0,setTimeout(function(){f.current=!1},1e3)},K=function(){var a=void 0===window.navigator?"":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(a)},L=function(a){t?"ArrowDown"===a.key?a.preventDefault():"ArrowUp"===a.key?(a.preventDefault(),w(function(a){return a>0?a-1:a})):"Tab"===a.key?a.preventDefault():"Enter"===a.key?a.preventDefault():"Escape"===a.key?(a.preventDefault(),u(!1)):w(0):"Enter"!==a.key||q||K()||a.shiftKey?"/"===a.key&&a.metaKey&&(a.preventDefault(),D(!C)):(a.preventDefault(),I())};return(0,y.useEffect)(function(){if(g&&g.current){var a,b;g.current.style.height="inherit",g.current.style.height="".concat(null===(a=g.current)|| void 0===a?void 0:a.scrollHeight,"px"),g.current.style.overflow="".concat((null==g?void 0:null===(b=g.current)|| void 0===b?void 0:b.scrollHeight)>400?"auto":"hidden")}},[n]),(0,m.jsx)("div",{className:"absolute bottom-0 left-0 w-full border-transparent bg-main-background pt-6 dark:border-white/20 md:pt-2",children:(0,m.jsxs)("div",{className:"stretch mx-2 mt-4 flex flex-row gap-3 last:mb-2 md:mx-4 md:mt-[52px] md:last:mb-6 lg:mx-auto lg:max-w-3xl",children:[i&&(0,m.jsxs)("button",{className:"absolute top-0 left-0 right-0 mx-auto mb-3 flex w-fit items-center gap-3 rounded border border-neutral-200 bg-white py-2 px-4 text-black hover:opacity-50 dark:border-neutral-600 dark:bg-[#343541] dark:text-white md:mb-0 md:mt-2",onClick:J,children:[(0,m.jsx)($.Z,{size:16})," ",k("멈추기")]}),!i&&j.length>0&&(0,m.jsxs)("button",{className:"absolute top-0 left-0 right-0 mx-auto mb-3 flex w-fit items-center gap-3 rounded border border-neutral-200 bg-white py-2 px-4 text-black hover:opacity-50 dark:border-neutral-600 bg-main-sidebar-background dark:text-white md:mb-0 md:mt-2",onClick:d,children:[(0,m.jsx)(_.Z,{size:16})," ",k("응답 재생성")]}),(0,m.jsxs)("div",{className:"relative mx-2 flex w-full flex-grow flex-col rounded-md border border-black/10 bg-white shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:border-gray-900/50 dark:text-white dark:shadow-[0_0_15px_rgba(0,0,0,0.10)] sm:mx-4 bg-main-sidebar-background",children:[(0,m.jsx)("textarea",{ref:g,className:"m-0 w-full resize-none border-0 bg-transparent p-0 py-2 pr-8 pl-10 dark:bg-transparent dark:text-white md:py-3 md:pl-10 bg-main-sidebar-background",style:{resize:"none",bottom:"".concat(null==g?void 0:null===(b=g.current)|| void 0===b?void 0:b.scrollHeight,"px"),maxHeight:"400px",overflow:"".concat(g.current&&g.current.scrollHeight>400?"auto":"hidden")},placeholder:k('Type a message or type "/" to select a prompt...')||"",value:n,rows:1,onCompositionStart:function(){return r(!0)},onCompositionEnd:function(){return r(!1)},onChange:H,onKeyDown:L}),(0,m.jsx)("button",{className:"absolute right-2 top-2 rounded-sm p-1 text-neutral-800 opacity-60 hover:bg-neutral-200 hover:text-neutral-900 dark:bg-opacity-50 dark:text-neutral-100 dark:hover:text-neutral-200",onClick:I,children:i?(0,m.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-t-2 border-neutral-800 opacity-60 dark:border-neutral-100"}):(0,m.jsx)(aa.Z,{size:18})}),h&&(0,m.jsx)("div",{className:"absolute bottom-12 right-0 lg:bottom-0 lg:-right-10",children:(0,m.jsx)("button",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-neutral-300 text-gray-800 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-neutral-200",onClick:e,children:(0,m.jsx)(ab.Z,{size:18})})})]})]})})},ad=c(22120),ae=c(86010);function af(a){var b=a.children,c=a.className;return(0,m.jsx)("main",{className:(0,ae.Z)("hover-animation flex min-h-screen w-full max-w-xl flex-col border-x-0\n         border-light-border dark:border-dark-border xs:border-x",c),children:b})}var ag=c(83454);function ah(){var a=(0,u.d)(),b=a.open,c=a.openModal,d=a.closeModal,e=(0,p.aC)().user,f=(0,y.useState)(),k=f[0],q=f[1],r=(0,y.useState)(!0),z=(r[0],r[1]),C=(0,y.useState)(!1);C[0],C[1];var D=(0,y.useState)(!1),E=D[0],F=D[1],G=(0,y.useRef)(!1),H=(0,y.useRef)(null),I=(0,y.useRef)(null),J=(0,y.useRef)(null),K=(0,y.useState)([]),L=K[0],M=K[1],N=(0,y.useState)(!1),O=N[0],P=N[1],Q=(0,y.useState)(!1),R=Q[0],S=Q[1];(0,ad.$G)("chat").t;var T,U=function(){if(I.current){var a=I.current,b=a.scrollTop,c=a.scrollHeight,d=a.clientHeight,e=30;b+d<c-e?(z(!1),F(!0)):(z(!0),F(!1))}},V=function(){M([])},W=function(){var a;null===(a=I.current)|| void 0===a||a.scrollTo({top:I.current.scrollHeight,behavior:"smooth"})},X=(0,y.useCallback)((T=(0,g.Z)(l().mark(function a(b){var c,d,e,f,g,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,C,D,E=arguments;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=E.length>1&& void 0!==E[1]?E[1]:0,d=E.length>2&& void 0!==E[2]?E[2]:null,c){for(g=0,f=(0,j.Z)(L);g<c;g++)f.pop();e=(0,j.Z)(f).concat([b])}else e=(0,j.Z)(L).concat([b]);return M(e),P(!0),S(!0),k={model:A["gpt-3.5-turbo"],messages:e,key:ag.env.OPEN_AI_API_KEY,prompt:b.content,temperature:1},m="api/chat",n=JSON.stringify(k),o=new AbortController,a.next=12,fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},signal:o.signal,body:n});case 12:if((p=a.sent).ok){a.next=18;break}return P(!1),S(!1),B.Am.error(p.statusText),a.abrupt("return");case 18:if(q=p.body,console.log("data : ",q),q){a.next=24;break}return P(!1),S(!1),a.abrupt("return");case 24:P(!1),r=q.getReader(),s=new TextDecoder,t=!1,u=!0,v="";case 30:if(t){a.next=46;break}if(!G.current){a.next=35;break}return o.abort(),t=!0,a.abrupt("break",46);case 35:return a.next=37,r.read();case 37:x=(w=a.sent).value,y=w.done,t=y,z=s.decode(x),v+=z,u?(u=!1,C=(0,j.Z)(L).concat([{role:"assistant",content:z},]),console.log("isFirst : ",C),M(C)):(D=L.map(function(a,b){return b===L.length-1?(0,i.Z)((0,h.Z)({},a),{content:v}):a}),console.log("not First : ",D),M(D)),a.next=30;break;case 46:P(!1),S(!1);case 48:case"end":return a.stop()}},a)})),function(a){return T.apply(this,arguments)}),[L,G,k]);return(0,m.jsxs)(af,{children:[(0,m.jsx)(n.H,{title:"맛집추천 / BungSin"}),(0,m.jsx)(s.u_,{modalClassName:"max-w-xs bg-main-background w-full p-8 rounded-2xl",open:b,closeModal:d,children:(0,m.jsx)(t.W,{title:"메세지를 모두 삭제하시겠습니까?",description:"현재 작성된 답변은 저장 혹은 기록되지 않으며, 답변은 항상 달라질 수 있습니다.",mainBtnClassName:"bg-accent-red hover:bg-accent-red/90 active:bg-accent-red/75 accent-tab focus-visible:bg-accent-red/90",mainBtnLabel:"삭제",action:V,closeModal:d})}),(0,m.jsxs)(o.c,{className:"flex items-center justify-between",useMobileSidebar:!0,children:[(0,m.jsxs)("div",{className:"-mb-1 flex flex-col",children:[(0,m.jsx)("h2",{className:"-mt-1 text-xl font-bold",children:"맛집추천"}),(0,m.jsxs)("p",{className:"text-xs text-light-secondary dark:text-dark-secondary",children:["@",null==e?void 0:e.username]})]}),(0,m.jsxs)(v.z,{className:"dark-bg-tab group relative p-2 hover:bg-light-primary/10 active:bg-light-primary/20 dark:hover:bg-dark-primary/10 dark:active:bg-dark-primary/20",onClick:c,children:[(0,m.jsx)(w.e,{className:"h-5 w-5",iconName:"ArchiveBoxXMarkIcon"}),(0,m.jsx)(x.e,{className:"!-translate-x-20 translate-y-3 md:-translate-x-1/2",tip:"메세지 전체 삭제"})]})]}),(0,m.jsx)("section",{className:"mt-10 relative h-full",children:(0,m.jsxs)("div",{className:"relative h-full overflow-hidden bg-white dark:bg-[#000]",children:[(0,m.jsx)("div",{className:"max-h-full overflow-x-hidden",ref:I,onScroll:U,children:0===L.length?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"mx-auto flex flex-col space-y-5 md:space-y-10 px-3 pt-5 md:pt-12 sm:max-w-[600px]",children:(0,m.jsx)("div",{className:"text-center text-3xl font-semibold text-gray-800 dark:text-gray-100",children:"Chatbot UI"})})}):(0,m.jsxs)(m.Fragment,{children:[L.map(function(a,b){return(0,m.jsx)(Y,{message:a,messages:L,setMessages:M,messageIsStreaming:R,messageIndex:b,onEdit:function(a){q(a),X(a,L.length-b)}},b)}),O&&(0,m.jsx)(Z,{}),(0,m.jsx)("div",{className:"h-[162px] bg-white dark:bg-[#000]",ref:H})]})}),(0,m.jsx)(ac,{stopConversationRef:G,textareaRef:J,onSend:function(a,b){q(a),X(a,0,b)},onScrollDownClick:W,messageIsStreaming:R,onRegenerate:function(){k&&X(k,0,null)},showScrollDownButton:E,messages:L})]})})]})}ah.getLayout=function(a){return(0,m.jsx)(q.IP,{children:(0,m.jsx)(r.Z,{children:(0,m.jsx)(q.Os,{children:a})})})}}},function(a){a.O(0,[879,986,387,118,367,774,888,179],function(){var b;return a(a.s=66117)}),_N_E=a.O()}])